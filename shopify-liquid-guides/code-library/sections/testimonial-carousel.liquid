{% comment %} sections/testimonial-carousel.liquid
Accessible carousel structure (HTML/Liquid only). Add light JS if needed. {% endcomment %}

<section
  class="carousel carousel--testimonials"
  role="region"
  aria-roledescription="carousel"
  aria-label="{{ section.settings.aria_label | default: 'Testimonials' | escape }}"
>
  <div class="carousel__inner container">
    <div class="carousel__header">
      {% if section.settings.heading != blank %}
        <h2 class="carousel__heading">{{ section.settings.heading | escape }}</h2>
      {% endif %}
      <div class="carousel__controls" aria-controls="Carousel-{{ section.id }}-viewport">
        <button type="button" class="carousel__prev" aria-label="Previous testimonial" aria-controls="Carousel-{{ section.id }}-viewport">&#10094;</button>
        <button type="button" class="carousel__next" aria-label="Next testimonial" aria-controls="Carousel-{{ section.id }}-viewport">&#10095;</button>
      </div>
    </div>

    <div class="carousel__viewport" id="Carousel-{{ section.id }}-viewport" tabindex="0">
      <ul class="carousel__slides" role="list">
        {% for block in section.blocks %}
          <li
            class="carousel__slide"
            role="group"
            aria-roledescription="slide"
            aria-label="{{ forloop.index }} of {{ section.blocks.size }}"
            {{ block.shopify_attributes }}
          >
            <figure class="testimonial">
              {% if block.settings.image %}
                <div class="testimonial__media">
                  <img
                    src="{{ block.settings.image | image_url: width: 240 }}"
                    alt="{{ block.settings.author | escape }}"
                    loading="lazy"
                    width="240"
                  >
                </div>
              {% endif %}
              <blockquote class="testimonial__quote">
                {{ block.settings.quote }}
              </blockquote>
              <figcaption class="testimonial__meta">
                <span class="testimonial__author">{{ block.settings.author | escape }}</span>
                {% if block.settings.role != blank %}
                  <span class="testimonial__role">{{ block.settings.role | escape }}</span>
                {% endif %}
              </figcaption>
            </figure>
          </li>
        {% endfor %}
      </ul>
    </div>

    <div class="carousel__status sr-only" aria-live="polite"></div>
  </div>
</section>

{% schema %}{
  "name": "Testimonial carousel (accessible)",
  "max_blocks": 10,
  "settings": [
    {"type": "text", "id": "heading", "label": "Heading", "default": "What our customers say"},
    {"type": "text", "id": "aria_label", "label": "Section aria-label (optional)"}
  ],
  "blocks": [
    {
      "type": "testimonial",
      "name": "Testimonial",
      "settings": [
        {"type": "text", "id": "author", "label": "Author", "default": "Jane Doe"},
        {"type": "text", "id": "role", "label": "Role / Company"},
        {"type": "richtext", "id": "quote", "label": "Quote", "default": "<p>This product is fantastic! It exceeded my expectations.</p>"},
        {"type": "image_picker", "id": "image", "label": "Author image"}
      ]
    }
  ],
  "presets": [
    {"name": "Testimonial carousel","blocks": [{"type":"testimonial"},{"type":"testimonial"}]}
  ]
}{% endschema %}

