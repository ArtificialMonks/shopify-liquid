# Advanced Warp Workflows for Shopify Liquid Development
# Integrates with the enterprise-grade validation system

workflows:
  # === ADVANCED VALIDATION WORKFLOWS ===
  
  validation-dev:
    name: "ğŸš€ Development Validation (Enhanced)"
    description: "Fast validation with Theme Check + Schema Integrity (includes /custom directories)"
    command: |
      echo "ğŸ” Running Enhanced Development Validation..."
      echo "âœ¨ Now includes schema integrity validation for comprehensive coverage!"
      ./scripts/validate-theme.sh development
  
  validation-comprehensive:
    name: "ğŸ” Comprehensive Validation"
    description: "Complete validation with all 50+ validation rules"
    command: |
      echo "ğŸ“‹ Running Comprehensive Validation..."
      ./scripts/validate-theme.sh comprehensive
  
  validation-production:
    name: "ğŸ¯ Production Validation"
    description: "Theme Store submission readiness validation"
    command: |
      echo "ğŸ† Running Production Validation (Theme Store Ready)..."
      ./scripts/validate-theme.sh production
  
  validation-all:
    name: "âœ¨ Complete Validation Suite"
    description: "Ultimate validation workflow - development â†’ auto-fix â†’ comprehensive â†’ production"
    command: |
      echo "ğŸš€ Running Complete Validation Suite..."
      ./scripts/validate-theme.sh all
  
  auto-fix:
    name: "ğŸ”§ Auto-Fix Issues"
    description: "Automatically correct fixable validation issues"
    command: |
      echo "ğŸ› ï¸ Running Auto-Fix for correctable issues..."
      ./scripts/validate-theme.sh auto-fix
  
  validation-report:
    name: "ğŸ“Š Generate Validation Report"
    description: "Create detailed JSON validation report for CI/CD"
    command: |
      echo "ğŸ“ˆ Generating detailed validation report..."
      ./scripts/validate-theme.sh report
      echo "Report saved to: theme-validation-report.json"
  
  validation-presets:
    name: "ğŸ›ï¸ Test Shopify Presets"
    description: "Test different Shopify validation preset configurations"
    command: |
      echo "ğŸ§ª Testing Shopify validation presets..."
      ./scripts/validate-theme.sh presets
  
  # === SCHEMA INTEGRITY VALIDATION ===
  
  schema-integrity:
    name: "ğŸ” Schema Integrity Scan"
    description: "Deep schema validation including range step calculations (catches violations we missed!)"
    command: |
      echo "ğŸ¯ Running Schema Integrity Validation..."
      echo "âš ï¸ This validation caught our range step error that other tools missed!"
      ./scripts/validate-theme.sh integrity
  
  schema-integrity-custom:
    name: "ğŸ†• Custom Directory Schema Check"
    description: "Validate schema integrity specifically for custom components"
    command: |
      echo "ğŸ”§ Validating custom directory components..."
      echo "ğŸ“ Scanning: blocks/custom/, sections/custom/, css-patterns/custom/"
      python3 scripts/scan-schema-integrity.py shopify-liquid-guides/code-library/blocks/custom/ 2>/dev/null || echo "â„¹ï¸ No custom blocks found"
      python3 scripts/scan-schema-integrity.py shopify-liquid-guides/code-library/sections/custom/ 2>/dev/null || echo "â„¹ï¸ No custom sections found"
      echo "âœ… Custom directory validation complete!"
  
  deep-validation:
    name: "ğŸ“Š Deep Validation Suite"
    description: "Enhanced + Schema Integrity + Comprehensive validation"
    command: |
      echo "ğŸ”¬ Running Deep Validation (Most Thorough)..."
      ./scripts/validate-theme.sh deep
  
  # === SHOPIFY CLI VALIDATION ===
  
  shopify-check-recommended:
    name: "âœ… Shopify Recommended Check"
    description: "Run Shopify's recommended validation preset"
    command: |
      echo "ğŸ… Running Shopify recommended validation..."
      shopify theme check --config theme-check:recommended
  
  shopify-check-all:
    name: "ğŸ” Shopify All Checks"
    description: "Run all available Shopify validation checks"
    command: |
      echo "ğŸŒ Running all Shopify validation checks..."
      shopify theme check --config theme-check:all
  
  shopify-auto-correct:
    name: "ğŸ”§ Shopify Auto-Correct"
    description: "Use Shopify CLI's built-in auto-correction"
    command: |
      echo "âš¡ Running Shopify CLI auto-correction..."
      shopify theme check --auto-correct
  
  # === LEGACY SUPPORT ===
  
  theme-check-legacy:
    name: "ğŸ›ï¸ Legacy Theme Check"
    description: "Run legacy theme-check gem on code library"
    command: |
      echo "ğŸ“œ Running legacy Theme Check on code library..."
      cd shopify-liquid-guides/code-library
      if command -v theme-check &> /dev/null; then
        theme-check .
      else
        echo "âš ï¸ theme-check gem not installed. Using Shopify CLI instead:"
        shopify theme check
      fi

  # === DOCUMENTATION & NAVIGATION ===
  
  docs-browse:
    name: "ğŸ“š Browse Documentation (Updated)"
    description: "Explore repository structure including new custom directories"
    command: |
      echo "ğŸ—‹ï¸ Shopify Liquid Documentation Repository"
      echo "=========================================="
      echo ""
      echo "ğŸ“š Documentation structure:"
      ls -la shopify-liquid-guides/docs/
      echo ""
      echo "ğŸ”§ Code library (Production-ready):"
      ls -la shopify-liquid-guides/code-library/
      echo ""
      echo "ğŸ†• NEW: Custom directories (Repository-specific components):"
      echo "  ğŸ§© Custom Blocks:"
      ls -la shopify-liquid-guides/code-library/blocks/custom/ 2>/dev/null || echo "    (No custom blocks yet)"
      echo "  ğŸ¨ Custom Sections:"
      ls -la shopify-liquid-guides/code-library/sections/custom/ 2>/dev/null || echo "    (No custom sections yet)"
      echo "  ğŸ¨ Custom CSS Patterns:"
      ls -la shopify-liquid-guides/code-library/css-patterns/custom/ 2>/dev/null || echo "    (No custom CSS patterns yet)"
      echo ""
      echo "ğŸ’¡ Complete examples:"
      ls -la shopify-liquid-guides/examples/
      echo ""
      echo "âš™ï¸ Validation configurations:"
      ls -la .theme-check*.yml scripts/
  
  validation-status:
    name: "ğŸ” Validation Status"
    description: "Show current validation setup and system status"
    command: |
      echo "ğŸ¯ Shopify Liquid Validation System Status"
      echo "==========================================="
      echo ""
      echo "ğŸ“¦ Shopify CLI Version:"
      shopify version
      echo ""
      echo "âš™ï¸ Available Configurations:"
      echo "  â€¢ Development: .theme-check-development.yml (Fast, essential checks)"
      echo "  â€¢ Comprehensive: .theme-check.yml (All 50+ rules)"
      echo "  â€¢ Production: .theme-check-production.yml (Theme Store ready)"
      echo ""
      echo "ğŸš€ Enhanced Multi-Level Validation Workflows:"
      echo "  â€¢ ./scripts/validate-theme.sh development (includes schema integrity)"
      echo "  â€¢ ./scripts/validate-theme.sh integrity    (schema validation + custom dirs)"
      echo "  â€¢ ./scripts/validate-theme.sh deep        (enhanced + integrity + comprehensive)"
      echo "  â€¢ ./scripts/validate-theme.sh all         (complete suite + custom dirs)"
      echo "  â€¢ python scripts/validate-all.py          (CI/CD pipeline ready)"
      echo ""
      echo "ğŸ†• Custom Directory Validation:"
      echo "  âœ“ blocks/custom/               (repository-specific block components)"
      echo "  âœ“ sections/custom/             (specialized section templates)"
      echo "  âœ“ css-patterns/custom/         (custom CSS methodologies)"
      echo ""
      echo "ğŸ“Š Last Validation Report:"
      if [ -f "theme-validation-report.json" ]; then
        echo "  âœ… Found: theme-validation-report.json"
        echo "  Modified: $(stat -f %Sm theme-validation-report.json)"
      else
        echo "  ğŸ“ No report found. Run 'validation-report' workflow to generate."
      fi

  # === SHOPIFY DEVELOPMENT ===
  
  serve-theme:
    name: "ğŸŒ Serve Shopify Theme"
    description: "Start Shopify theme development server (requires complete theme)"
    parameters:
      - name: theme_path
        description: "Path to complete theme directory with all 7 file types"
        required: true
      - name: store
        description: "Shopify store URL (optional if already authenticated)"
        required: false
    command: |
      {% if store %}
      echo "ğŸ”— Authenticating with store: {{ store }}"
      shopify login --store={{ store }}
      {% endif %}
      
      echo "ğŸš€ Starting theme server for: {{ theme_path }}"
      cd {{ theme_path }}
      
      # Verify this is a complete theme
      if [ ! -d "config" ] || [ ! -d "layout" ] || [ ! -d "sections" ]; then
        echo "âŒ Error: Not a complete theme directory!"
        echo "ğŸ“ Required folders: config/, layout/, sections/, snippets/, templates/, assets/, locales/"
        echo "ğŸ“ Use examples from shopify-liquid-guides/examples/ as reference"
        exit 1
      fi
      
      echo "âœ… Theme structure verified - all required directories found"
      shopify theme serve
  
  shopify-auth:
    name: "ğŸ” Shopify Authentication"
    description: "Login to Shopify store and verify authentication"
    parameters:
      - name: store
        description: "Shopify store URL (e.g., your-store.myshopify.com)"
        required: true
    command: |
      echo "ğŸ”‘ Authenticating with Shopify store: {{ store }}"
      shopify login --store={{ store }}
      echo ""
      echo "âœ… Authentication status:"
      shopify whoami

  shopify-theme-check:
    name: "âœ… Shopify Theme Check"
    description: "Run Shopify CLI theme validation on complete theme directory"
    parameters:
      - name: theme_path
        description: "Path to complete theme directory"
        required: true
    command: |
      echo "ğŸ” Running Shopify theme check on: {{ theme_path }}"
      cd {{ theme_path }}
      shopify theme check
  
  # === SCHEMA & DOCUMENTATION ===
  
  schema-validate:
    name: "ğŸ“‹ Schema Validation Guide"
    description: "Display critical schema validation rules and guidelines"
    command: |
      echo "ğŸ¯ Schema Validation Quick Reference"
      echo "==================================="
      echo ""
      echo "ğŸ”´ Critical validation rules to remember:"
      echo "  â€¢ Range step calculation: (max - min) / step â‰¤ 101"
      echo "  â€¢ Use 'video' not 'file' for video uploads"
      echo "  â€¢ No 'enabled_on' in section schemas (app blocks only)"
      echo "  â€¢ Step values â‰¥ 0.1 for all ranges"
      echo "  â€¢ Valid JSON syntax (no trailing commas)"
      echo "  â€¢ Unique setting IDs within each section"
      echo ""
      echo "ğŸ“š Complete guidelines at:"
      echo "  â†’ shopify-liquid-guides/schema-validation/schema-guidelines.md"
      echo ""
      echo "ğŸ“ Additional resources:"
      echo "  â†’ THEME-CHECK-SETUP.md - Complete validation system guide"
      echo "  â†’ shopify-liquid-guides/04-blocks-and-css-scoping.md - CSS patterns"
  
  # === ENVIRONMENT SETUP ===

  quick-setup:
    name: "âš¡ Quick Environment Setup"
    description: "Install and verify required tools for Shopify development with advanced validation"
    command: |
      echo "ğŸš€ Advanced Shopify Development Environment Setup"
      echo "================================================"
      echo ""
      
      # Update Homebrew
      echo "ğŸº Updating Homebrew..."
      /opt/homebrew/bin/brew update
      
      # Install essential tools
      echo "ğŸ“¦ Installing Node.js and Shopify CLI..."
      /opt/homebrew/bin/brew install node
      npm install -g @shopify/cli
      
      # Optional: Install Ruby and legacy theme-check
      echo "ğŸ”´ Installing Ruby (optional for legacy support)..."
      /opt/homebrew/bin/brew install ruby
      gem install theme-check
      
      # Verify installations
      echo ""
      echo "âœ… Verifying installations:"
      echo "  â€¢ Node.js: $(node -v)"
      echo "  â€¢ npm: $(npm -v)"
      echo "  â€¢ Shopify CLI: $(shopify version)"
      if command -v ruby &> /dev/null; then
        echo "  â€¢ Ruby: $(ruby -v)"
      fi
      if command -v theme-check &> /dev/null; then
        echo "  â€¢ Theme Check gem: $(theme-check -v)"
      fi
      
      echo ""
      echo "ğŸ¯ Next steps:"
      echo "1. Authenticate: Run 'shopify-auth' workflow"
      echo "2. Test validation: Run 'validation-dev' workflow"
      echo "3. Explore: Run 'docs-browse' workflow"
  
  project-info:
    name: "ğŸ“Š Project Information"
    description: "Display repository structure, validation system, and key features"
    command: |
      echo "ğŸ† Advanced Shopify Liquid Documentation Repository"
      echo "==================================================="
      echo ""
      echo "ğŸ¯ Purpose: Comprehensive Shopify theme development with enterprise validation"
      echo ""
      echo "ğŸ“š Key directories:"
      echo "â”œâ”€â”€ shopify-liquid-guides/docs/          â†’ Complete documentation (all 7 file types)"
      echo "â”œâ”€â”€ shopify-liquid-guides/code-library/  â†’ Production-ready code examples"
      echo "â”‚   â”œâ”€â”€ blocks/custom/              â†’ ğŸ†• Repository-specific blocks"
      echo "â”‚   â”œâ”€â”€ sections/custom/            â†’ ğŸ†• Repository-specific sections"
      echo "â”‚   â””â”€â”€ css-patterns/custom/        â†’ ğŸ†• Repository-specific CSS patterns"
      echo "â”œâ”€â”€ shopify-liquid-guides/examples/      â†’ Complete theme templates"
      echo "â”œâ”€â”€ scripts/                         â†’ Enhanced validation workflows"
      echo "â”œâ”€â”€ locales/                         â†’ Translation support"
      echo "â”œâ”€â”€ .vscode/                         â†’ VS Code integration"
      echo "â”œâ”€â”€ .warp/                           â†’ Enhanced Warp workflows"
      echo "â””â”€â”€ WARP.md                          â†’ Updated comprehensive guide"
      echo ""
      echo "ğŸ”‘ Essential validation files:"
      echo "  â€¢ THEME-CHECK-SETUP.md - Ultimate validation system guide"
      echo "  â€¢ .theme-check-development.yml - Fast development validation"
      echo "  â€¢ .theme-check.yml - Comprehensive validation (50+ rules)"
      echo "  â€¢ .theme-check-production.yml - Theme Store submission ready"
      echo "  â€¢ scripts/validate-theme.sh - Multi-level validation workflow"
      echo ""
      echo "ğŸ“š Documentation highlights:"
      echo "  â€¢ WARP.md - Warp terminal guidance (this file)"
      echo "  â€¢ INSTRUCTIONS.md - Task-specific development guidance"
      echo "  â€¢ schema-validation/schema-guidelines.md - CRITICAL validation rules"
      echo ""
      echo "ğŸš€ Quick start workflows:"
      echo "  1. 'validation-status' - Check system status"
      echo "  2. 'validation-dev' - Fast development validation"
      echo "  3. 'validation-all' - Complete validation suite"
      echo "  4. 'docs-browse' - Explore repository structure"
